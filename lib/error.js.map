{"version":3,"sources":["lib/error.ts"],"names":[],"mappings":"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","file":"error.js","sourcesContent":["export class PlumError {\r\n    constructor(public status: number, public code: string, public message: string) {\r\n    };\r\n}\r\n\r\nexport class ParametersPlumError extends PlumError {\r\n    constructor(message: string) {\r\n        super(400, PlumErrorCodes.parameters_error, message);\r\n    }\r\n}\r\n\r\nexport class UnauthorizedPlumError extends PlumError {\r\n    constructor(message: string = \"Unauthorized access\") {\r\n        super(401, PlumErrorCodes.unauthorized, message);\r\n    }\r\n}\r\n\r\nexport class ForbiddenPlumError extends PlumError {\r\n    constructor(message: string = \"Access forbidden\") {\r\n        super(403, PlumErrorCodes.forbidden, message);\r\n    }\r\n}\r\n\r\nexport class NotFoundPlumError extends PlumError {\r\n    constructor(message: string = \"Entity not found error\") {\r\n        super(404, PlumErrorCodes.not_found, message);\r\n    }\r\n}\r\n\r\nexport class NotAllowedPlumError extends PlumError {\r\n    constructor(message: string = \"Method not allowed error\", public scope?: any) {\r\n        super(405, PlumErrorCodes.not_allowed, message);\r\n    }\r\n}\r\n\r\nexport class TimeoutPlumError extends PlumError {\r\n    constructor(message: string = \"Method timeout error\", public scope?: any) {\r\n        super(408, PlumErrorCodes.timeout, message);\r\n    }\r\n}\r\n\r\nexport class PreconditionFailedPlumError extends PlumError {\r\n    constructor(message: string = null) {\r\n        super(412, PlumErrorCodes.predondition_error, message);\r\n    }\r\n}\r\n\r\nexport class FieldError {\r\n    constructor(public code: string, public message: string) {\r\n    }\r\n}\r\n\r\nexport class ValidationPlumError extends PlumError {\r\n    constructor(public fields: { [key: string]: FieldError; }, message: string = null) {\r\n        super(422, PlumErrorCodes.validation_error, message);\r\n    }\r\n}\r\n\r\nexport class ServerPlumError extends PlumError {\r\n    constructor(message: string = \"Unexpected server error\") {\r\n        super(500, PlumErrorCodes.server_error, message);\r\n    }\r\n}\r\n\r\nexport const transformSenecaError = (err: any): PlumError | any => {\r\n    if (err instanceof  PlumError) {\r\n        return err;\r\n    } else if (err.seneca && err.details && err.details.message) {\r\n        switch (err.details.message) {\r\n            case \"[TIMEOUT]\":\r\n                return new TimeoutPlumError(err.msg);\r\n        }\r\n    } else {\r\n        return new ServerPlumError(err.message);\r\n    }\r\n};\r\n\r\n/** Utility function to create a K:V from a list of strings */\r\nfunction strEnum<T extends string>(o: Array<T>): {[K in T]: K} {\r\n    return o.reduce((res, key) => {\r\n        res[key] = key;\r\n        return res;\r\n    }, Object.create(null));\r\n}\r\n\r\n/** Create a K:V */\r\nexport const PlumErrorCodes = strEnum([\r\n    \"server_error\",\r\n    \"not_found\",\r\n    \"not_allowed\",\r\n    \"forbidden\",\r\n    \"timeout\",\r\n    \"unauthorized\",\r\n    \"parameters_error\",\r\n    \"validation_error\",\r\n    \"predondition_error\",\r\n]);\r\n/** Create a Type */\r\nexport type PlumErrorCodes = keyof typeof PlumErrorCodes;"]}