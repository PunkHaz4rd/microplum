{"version":3,"sources":["lib/error.ts"],"names":[],"mappings":"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","file":"error.js","sourcesContent":["export class PlumError {\r\n    constructor(public status: number, public code: string, public message: string) {\r\n    };\r\n}\r\n\r\nexport class ParametersPlumError extends PlumError {\r\n    constructor(message: string) {\r\n        super(400, PlumErrorCodes.parameters_error, message);\r\n    }\r\n}\r\n\r\nexport class UnauthorizedPlumError extends PlumError {\r\n    constructor(message: string = \"Unauthorized access\") {\r\n        super(401, PlumErrorCodes.unauthorized, message);\r\n    }\r\n}\r\n\r\nexport class ForbiddenPlumError extends PlumError {\r\n    constructor(message: string = \"Access forbidden\") {\r\n        super(403, PlumErrorCodes.forbidden, message);\r\n    }\r\n}\r\n\r\nexport class NotFoundPlumError extends PlumError {\r\n    constructor(message: string = \"Entity not found error\") {\r\n        super(404, PlumErrorCodes.not_found, message);\r\n    }\r\n}\r\n\r\nexport class NotAllowedPlumError extends PlumError {\r\n    constructor(message: string = \"Method not allowed error\", public scope?: any) {\r\n        super(405, PlumErrorCodes.not_allowed, message);\r\n    }\r\n}\r\n\r\nexport class TimeoutPlumError extends PlumError {\r\n    constructor(message: string = \"Method timeout error\", public scope?: any) {\r\n        super(408, PlumErrorCodes.timeout, message);\r\n    }\r\n}\r\n\r\nexport class PreconditionFailedPlumError extends PlumError {\r\n    constructor(message: string = null) {\r\n        super(412, PlumErrorCodes.predondition_error, message);\r\n    }\r\n}\r\n\r\nexport class FieldError {\r\n    constructor(public code: string, public message: string) {\r\n    }\r\n}\r\n\r\nexport class ValidationPlumError extends PlumError {\r\n    constructor(public fields: { [key: string]: FieldError; }, message: string = null) {\r\n        super(422, PlumErrorCodes.validation_error, message);\r\n    }\r\n}\r\n\r\nexport class ServerPlumError extends PlumError {\r\n    constructor(message: string = \"Unexpected server error\") {\r\n        super(500, PlumErrorCodes.server_error, message);\r\n    }\r\n}\r\n\r\nexport const transformSenecaError = (err: any): PlumError | any => {\r\n    if (err instanceof  PlumError) {\r\n        return err;\r\n    } else if (err.seneca && err.details && err.details.message) {\r\n        switch (err.details.message) {\r\n            case \"[TIMEOUT]\":\r\n                return new TimeoutPlumError(err.msg);\r\n        }\r\n    } else {\r\n        return new ServerPlumError(err.message);\r\n    }\r\n};\r\n\r\n/** Utility function to create a K:V from a list of strings */\r\nfunction strEnum<T extends string>(o: Array<T>): {[K in T]: K} {\r\n    return o.reduce((res, key) => {\r\n        res[key] = key;\r\n        return res;\r\n    }, Object.create(null));\r\n}\r\n\r\n/** Create a K:V */\r\nexport const PlumErrorCodes = strEnum([\r\n    \"server_error\",\r\n    \"not_found\",\r\n    \"not_allowed\",\r\n    \"forbidden\",\r\n    \"timeout\",\r\n    \"unauthorized\",\r\n    \"parameters_error\",\r\n    \"validation_error\",\r\n    \"predondition_error\",\r\n]);\r\n/** Create a Type */\r\nexport type PlumErrorCodes = keyof typeof PlumErrorCodes;"]}